openapi: 3.0.3
info:
  title: Todo App - Authentication API
  description: Authentication endpoints for user signup, signin, and JWT token management
  version: 1.0.0
  contact:
    name: Todo App Team

servers:
  - url: http://localhost:8000
    description: Local development server
  - url: https://api.todo-app.com
    description: Production server

tags:
  - name: Authentication
    description: User authentication operations

paths:
  /auth/signup:
    post:
      tags:
        - Authentication
      summary: Create new user account
      description: Register a new user with email and password. Returns JWT token on success.
      operationId: signup
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignupRequest'
            examples:
              valid:
                summary: Valid signup request
                value:
                  email: user@example.com
                  password: password123
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
              examples:
                success:
                  summary: Successful signup
                  value:
                    data:
                      user:
                        id: 550e8400-e29b-41d4-a716-446655440000
                        email: user@example.com
                        created_at: '2026-01-14T10:30:00Z'
                      token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                    message: Account created successfully
                    error: null
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_email:
                  summary: Invalid email format
                  value:
                    data: null
                    message: null
                    error:
                      code: INVALID_EMAIL
                      message: Invalid email format
                      details: {}
                email_exists:
                  summary: Email already registered
                  value:
                    data: null
                    message: null
                    error:
                      code: EMAIL_EXISTS
                      message: Email already registered
                      details: {}
                weak_password:
                  summary: Password too short
                  value:
                    data: null
                    message: null
                    error:
                      code: WEAK_PASSWORD
                      message: Password must be at least 8 characters
                      details: {}
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/signin:
    post:
      tags:
        - Authentication
      summary: Sign in existing user
      description: Authenticate user with email and password. Returns JWT token on success.
      operationId: signin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SigninRequest'
            examples:
              valid:
                summary: Valid signin request
                value:
                  email: user@example.com
                  password: password123
      responses:
        '200':
          description: User authenticated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
              examples:
                success:
                  summary: Successful signin
                  value:
                    data:
                      user:
                        id: 550e8400-e29b-41d4-a716-446655440000
                        email: user@example.com
                        created_at: '2026-01-14T10:30:00Z'
                      token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                    message: Signed in successfully
                    error: null
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_credentials:
                  summary: Wrong email or password
                  value:
                    data: null
                    message: null
                    error:
                      code: INVALID_CREDENTIALS
                      message: Invalid email or password
                      details: {}
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    SignupRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          maxLength: 255
          description: User's email address
          example: user@example.com
        password:
          type: string
          minLength: 8
          maxLength: 100
          description: User's password (minimum 8 characters)
          example: password123

    SigninRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          maxLength: 255
          description: User's email address
          example: user@example.com
        password:
          type: string
          description: User's password
          example: password123

    UserResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: User's unique identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        email:
          type: string
          format: email
          description: User's email address
          example: user@example.com
        created_at:
          type: string
          format: date-time
          description: Account creation timestamp
          example: '2026-01-14T10:30:00Z'

    AuthResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            user:
              $ref: '#/components/schemas/UserResponse'
            token:
              type: string
              description: JWT authentication token
              example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        message:
          type: string
          description: Success message
          example: Account created successfully
        error:
          type: 'null'
          description: Error object (null on success)

    ErrorResponse:
      type: object
      properties:
        data:
          type: 'null'
          description: Data object (null on error)
        message:
          type: 'null'
          description: Message (null on error)
        error:
          type: object
          properties:
            code:
              type: string
              description: Error code
              example: INVALID_EMAIL
            message:
              type: string
              description: Human-readable error message
              example: Invalid email format
            details:
              type: object
              description: Additional error context
              example: {}
